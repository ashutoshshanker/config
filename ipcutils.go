package  main
import ( "git.apache.org/thrift.git/lib/go/thrift")

func CreateIPCHandles(address string) (thrift.TTransport , *thrift.TBinaryProtocolFactory) {
	 var transportFactory thrift.TTransportFactory
	 var transport thrift.TTransport
    var protocolFactory *thrift.TBinaryProtocolFactory 
	 var err error

	 protocolFactory  = thrift.NewTBinaryProtocolFactoryDefault()
	 transportFactory = thrift.NewTTransportFactory()
	 transport, err = thrift.NewTSocket(address)
	 transport = transportFactory.GetTransport(transport)
	 if err = transport.Open(); err != nil {
	     logger.Println("Failed to Open Transport" , transport, protocolFactory)
		  return nil, nil
	 }
	 return transport, protocolFactory
}
